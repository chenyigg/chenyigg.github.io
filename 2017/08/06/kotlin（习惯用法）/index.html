<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Kotlin--习惯用法 · Hexo</title><meta name="description" content="Kotlin--习惯用法 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Kotlin--习惯用法</h1><div class="post-info">Aug 6, 2017</div><div class="post-content"><h1 id="kotlin习惯用法"><a href="#Kotlin（习惯用法）" class="headerlink" title="Kotlin（习惯用法）"></a>Kotlin（习惯用法）</h1><h3 id="创建-dtospojospocos"><a href="#创建-DTOs（POJOs-POCOs）" class="headerlink" title="创建 DTOs（POJOs/POCOs）"></a>创建 DTOs（POJOs/POCOs）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> email: String)</div></pre></td></tr></table></figure>
<p>会为 Customer 类提供以下功能：</p>
<ul>
<li>所有属性的 getters （对于 var 定义的还有 setters）</li>
<li>equals()</li>
<li>hashCode()</li>
<li>toString()</li>
<li>copy()</li>
<li>所有属性的 component1() 、 component2() ……等等</li>
</ul>
<h3 id="函数的默认参数"><a href="#函数的默认参数" class="headerlink" title="函数的默认参数"></a>函数的默认参数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">(a: <span class="type">Int</span> = <span class="number">0</span>, b: <span class="type">String</span> = <span class="string">""</span>)</span></span> &#123; …… &#125;</div></pre></td></tr></table></figure>
<h3 id="过滤-list"><a href="#过滤-list" class="headerlink" title="过滤 list"></a>过滤 list</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> positives = list.filter &#123; x -&gt; x &gt; <span class="number">0</span> &#125;</div></pre></td></tr></table></figure>
<h5 id="或者可以更短"><a href="#或者可以更短：" class="headerlink" title="或者可以更短："></a>或者可以更短：</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> positives = list.filter &#123; it &gt; <span class="number">0</span> &#125;</div></pre></td></tr></table></figure>
<h3 id="string-内插"><a href="#String-内插" class="headerlink" title="String 内插"></a>String 内插</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">println(<span class="string">"Name <span class="variable">$name</span>"</span>)</div></pre></td></tr></table></figure>
<h3 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">when</span> (x) &#123;</div><div class="line">    <span class="keyword">is</span> Foo <span class="comment">//-&gt; ……</span></div><div class="line">    <span class="keyword">is</span> Bar <span class="comment">//-&gt; ……</span></div><div class="line">    <span class="keyword">else</span> <span class="comment">//-&gt; ……</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="遍历-mappair-型-list"><a href="#遍历-map-pair-型-list" class="headerlink" title="遍历 map/pair 型 list"></a>遍历 map/pair 型 list</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> ((k, v) <span class="keyword">in</span> map) &#123;</div><div class="line">	println(<span class="string">"<span class="variable">$k</span> -&gt; <span class="variable">$v</span>"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="使用区间"><a href="#使用区间" class="headerlink" title="使用区间"></a>使用区间</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.100</span>) &#123; …… &#125; <span class="comment">// 闭区间：包含 100</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span> until <span class="number">100</span>) &#123; …… &#125; <span class="comment">// 半开区间：不包含 100</span></div><div class="line"><span class="keyword">for</span> (x <span class="keyword">in</span> <span class="number">2.</span><span class="number">.10</span> step <span class="number">2</span>) &#123; …… &#125;</div><div class="line"><span class="keyword">for</span> (x <span class="keyword">in</span> <span class="number">10</span> downTo <span class="number">1</span>) &#123; …… &#125;</div><div class="line"><span class="keyword">if</span> (x <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) &#123; …… &#125;</div></pre></td></tr></table></figure>
<h3 id="只读-list"><a href="#只读-list" class="headerlink" title="只读 list"></a>只读 list</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> list = listOf(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)</div></pre></td></tr></table></figure>
<h3 id="只读-map"><a href="#只读-map" class="headerlink" title="只读 map"></a>只读 map</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">println(map[<span class="string">"key"</span>])</div><div class="line">map[<span class="string">"key"</span>] = value</div></pre></td></tr></table></figure>
<h3 id="延迟属性"><a href="#延迟属性" class="headerlink" title="延迟属性"></a>延迟属性</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> p: String <span class="keyword">by</span> lazy &#123;</div><div class="line">	<span class="comment">// 计算该字符串</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="扩展函数"><a href="#扩展函数" class="headerlink" title="扩展函数"></a>扩展函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">spaceToCamelCase</span><span class="params">()</span></span> &#123; …… &#125;</div><div class="line"><span class="string">"Convert this to camelcase"</span>.spaceToCamelCase()</div></pre></td></tr></table></figure>
<h3 id="创建单例"><a href="#创建单例" class="headerlink" title="创建单例"></a>创建单例</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">object</span> Resource &#123;</div><div class="line">	<span class="keyword">val</span> name = <span class="string">"Name"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="if-not-null-缩写"><a href="#if-not-null-缩写" class="headerlink" title="if not null 缩写"></a>if not null 缩写</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> files = File(<span class="string">"Test"</span>).listFiles()</div><div class="line">println(files?.size)</div></pre></td></tr></table></figure>
<h3 id="if-not-null-and-else-缩写"><a href="#If-not-null-and-else-缩写" class="headerlink" title="If not null and else 缩写"></a>If not null and else 缩写</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> files = File(<span class="string">"Test"</span>).listFiles()</div><div class="line">println(files?.size ?: <span class="string">"empty"</span>)</div></pre></td></tr></table></figure>
<h3 id="if-null-执行一个语句"><a href="#if-null-执行一个语句" class="headerlink" title="if null 执行一个语句"></a>if null 执行一个语句</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> <span class="keyword">data</span> = ……</div><div class="line"><span class="keyword">val</span> email = <span class="keyword">data</span>[<span class="string">"email"</span>] ?: <span class="keyword">throw</span> IllegalStateException(<span class="string">"Email is missing!"</span>)</div></pre></td></tr></table></figure>
<h3 id="if-not-null-执行代码"><a href="#if-not-null-执行代码" class="headerlink" title="if not null 执行代码"></a>if not null 执行代码</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> <span class="keyword">data</span> = ……</div><div class="line"><span class="keyword">data</span>?.let &#123;</div><div class="line">	…… <span class="comment">// 代码会执行到此处, 假如data不为null</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="映射可空值如果非空的话"><a href="#映射可空值（如果非空的话）" class="headerlink" title="映射可空值（如果非空的话）"></a>映射可空值（如果非空的话）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> <span class="keyword">data</span> = ……</div><div class="line"><span class="keyword">val</span> mapped = <span class="keyword">data</span>?.let &#123; transformData(it) &#125; ?: defaultValueIfDataIsNull</div></pre></td></tr></table></figure>
<h3 id="返回-when-表达式"><a href="#返回-when-表达式" class="headerlink" title="返回 when 表达式"></a>返回 when 表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">transform</span><span class="params">(color: <span class="type">String</span>)</span></span>: <span class="built_in">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">when</span> (color) &#123;</div><div class="line">        <span class="string">"Red"</span> -&gt; <span class="number">0</span></div><div class="line">        <span class="string">"Green"</span> -&gt; <span class="number">1</span></div><div class="line">        <span class="string">"Blue"</span> -&gt; <span class="number">2</span></div><div class="line">        <span class="keyword">else</span> -&gt; <span class="keyword">throw</span> IllegalArgumentException(<span class="string">"Invalid color param value"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="trycatch表达式"><a href="#“try-catch”表达式" class="headerlink" title="“try/catch”表达式"></a>“try/catch”表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> result = <span class="keyword">try</span> &#123;</div><div class="line">    	count()</div><div class="line">    &#125; <span class="keyword">catch</span> (e: ArithmeticException) &#123;</div><div class="line">    	<span class="keyword">throw</span> IllegalStateException(e)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 使用 result</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="if表达式"><a href="#“if”表达式" class="headerlink" title="“if”表达式"></a>“if”表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">(param: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> result = <span class="keyword">if</span> (param == <span class="number">1</span>) &#123;</div><div class="line">    	<span class="string">"one"</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (param == <span class="number">2</span>) &#123;</div><div class="line">    	<span class="string">"two"</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">    	<span class="string">"three"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="返回类型为-unit-的方法的-builder-风格用法"><a href="#返回类型为-Unit-的方法的-Builder-风格用法" class="headerlink" title="返回类型为 Unit 的方法的 Builder 风格用法"></a>返回类型为 Unit 的方法的 Builder 风格用法</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">arrayOfMinusOnes</span><span class="params">(size: <span class="type">Int</span>)</span></span>: IntArray &#123;</div><div class="line">	<span class="keyword">return</span> IntArray(size).apply &#123; fill(<span class="number">-1</span>) &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="单表达式函数"><a href="#单表达式函数" class="headerlink" title="单表达式函数"></a>单表达式函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">theAnswer</span><span class="params">()</span></span> = <span class="number">42</span></div></pre></td></tr></table></figure>
<h3 id="对一个对象实例调用多个方法-with"><a href="#对一个对象实例调用多个方法-（-with-）" class="headerlink" title="对一个对象实例调用多个方法 （ with ）"></a>对一个对象实例调用多个方法 （ with ）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Turtle</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">penDown</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">penUp</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">turn</span><span class="params">(degrees: <span class="type">Double</span>)</span></span></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">forward</span><span class="params">(pixels: <span class="type">Double</span>)</span></span></div><div class="line">&#125;</div><div class="line"><span class="keyword">val</span> myTurtle = Turtle()</div><div class="line">with(myTurtle) &#123; <span class="comment">// 画一个 100 像素的正方形</span></div><div class="line">    penDown()</div><div class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.4</span>) &#123;</div><div class="line">        forward(<span class="number">100.0</span>)</div><div class="line">        turn(<span class="number">90.0</span>)</div><div class="line">  	&#125;</div><div class="line">	penUp()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="对于需要泛型信息的泛型函数的适宜形式"><a href="#对于需要泛型信息的泛型函数的适宜形式" class="headerlink" title="对于需要泛型信息的泛型函数的适宜形式"></a>对于需要泛型信息的泛型函数的适宜形式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T: Any&gt;</span> Gson.<span class="title">fromJson</span><span class="params">(json)</span></span>: T = <span class="keyword">this</span>.fromJson(json, T::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></div></pre></td></tr></table></figure>
<h3 id="使用可空布尔"><a href="#使用可空布尔" class="headerlink" title="使用可空布尔"></a>使用可空布尔</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> b: <span class="built_in">Boolean</span>? = ……</div><div class="line"><span class="keyword">if</span> (b == <span class="literal">true</span>) &#123;</div><div class="line">	……</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">	<span class="comment">// `b` 是 false 或者 null</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/08/26/Java 并发机制的底层实现原理/" class="prev">PREV</a><a href="/2017/08/06/Kotlin（基础）/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>